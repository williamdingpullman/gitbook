<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Trying | GLMM, Concepts, &amp; R</title>
  <meta name="description" content="The webpages are mainly about logit models." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Trying | GLMM, Concepts, &amp; R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The webpages are mainly about logit models." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Trying | GLMM, Concepts, &amp; R" />
  
  <meta name="twitter:description" content="The webpages are mainly about logit models." />
  

<meta name="author" content="Bill Last Updated:" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bill's Stat Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: Motivation</a></li>
<li class="chapter" data-level="1" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>1</b> Basics</a><ul>
<li class="chapter" data-level="1.1" data-path="basics.html"><a href="basics.html#logit"><i class="fa fa-check"></i><b>1.1</b> Logit</a></li>
<li class="chapter" data-level="1.2" data-path="basics.html"><a href="basics.html#probit"><i class="fa fa-check"></i><b>1.2</b> Probit</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> MLE</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#basic-idea-of-mle"><i class="fa fa-check"></i><b>2.1</b> Basic idea of MLE</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#coin-flip-example-probit-and-logit"><i class="fa fa-check"></i><b>2.2</b> Coin flip example, probit, and logit</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#probit-1"><i class="fa fa-check"></i><b>2.2.1</b> Probit</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#logit-1"><i class="fa fa-check"></i><b>2.2.2</b> Logit</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#further-on-logit"><i class="fa fa-check"></i><b>2.3</b> Further on logit</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#references"><i class="fa fa-check"></i><b>2.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>3</b> Linear Mixed Models</a><ul>
<li class="chapter" data-level="3.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#lm-and-glm"><i class="fa fa-check"></i><b>3.1</b> LM and GLM</a><ul>
<li class="chapter" data-level="3.1.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#lm"><i class="fa fa-check"></i><b>3.1.1</b> LM</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#glm-definition"><i class="fa fa-check"></i><b>3.1.2</b> GLM-Definition</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#glm-log-link-example"><i class="fa fa-check"></i><b>3.1.3</b> GLM-log link example</a></li>
<li class="chapter" data-level="3.1.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#glm-reciprocal-link"><i class="fa fa-check"></i><b>3.1.4</b> GLM-Reciprocal link:</a></li>
<li class="chapter" data-level="3.1.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#glm-exponential-family"><i class="fa fa-check"></i><b>3.1.5</b> GLM-exponential family:</a></li>
<li class="chapter" data-level="3.1.6" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#canonical-exponential-family"><i class="fa fa-check"></i><b>3.1.6</b> Canonical exponential family</a></li>
<li class="chapter" data-level="3.1.7" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#canonical-exponential-family---expected-value-and-variance"><i class="fa fa-check"></i><b>3.1.7</b> Canonical exponential family - Expected value and variance</a></li>
<li class="chapter" data-level="3.1.8" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#expected-value-and-variance---possion-example"><i class="fa fa-check"></i><b>3.1.8</b> Expected value and variance - Possion Example</a></li>
<li class="chapter" data-level="3.1.9" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#canonical-link"><i class="fa fa-check"></i><b>3.1.9</b> Canonical link</a></li>
<li class="chapter" data-level="3.1.10" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#canonical-link---bernoulli"><i class="fa fa-check"></i><b>3.1.10</b> Canonical link - Bernoulli</a></li>
<li class="chapter" data-level="3.1.11" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#nr---bernoulli"><i class="fa fa-check"></i><b>3.1.11</b> NR - Bernoulli</a></li>
<li class="chapter" data-level="3.1.12" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#iteratively-re-weighted-least-squares"><i class="fa fa-check"></i><b>3.1.12</b> Iteratively Re-weighted Least Squares</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#lmm"><i class="fa fa-check"></i><b>3.2</b> LMM</a></li>
<li class="chapter" data-level="3.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#calculate-mean"><i class="fa fa-check"></i><b>3.3</b> Calculate mean</a></li>
<li class="chapter" data-level="3.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#test-the-treatment-effect"><i class="fa fa-check"></i><b>3.4</b> Test the treatment effect</a></li>
<li class="chapter" data-level="3.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#another-example"><i class="fa fa-check"></i><b>3.5</b> Another example</a></li>
<li class="chapter" data-level="3.6" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#full-lmm-model"><i class="fa fa-check"></i><b>3.6</b> Full LMM model</a></li>
<li class="chapter" data-level="3.7" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#serial-correlations-in-time-and-space"><i class="fa fa-check"></i><b>3.7</b> Serial correlations in time and space</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-stat-concepts.html"><a href="basic-stat-concepts.html"><i class="fa fa-check"></i><b>4</b> Basic Stat Concepts</a><ul>
<li class="chapter" data-level="4.1" data-path="basic-stat-concepts.html"><a href="basic-stat-concepts.html#score"><i class="fa fa-check"></i><b>4.1</b> Score</a></li>
<li class="chapter" data-level="4.2" data-path="basic-stat-concepts.html"><a href="basic-stat-concepts.html#gradient-and-jacobian"><i class="fa fa-check"></i><b>4.2</b> Gradient and Jacobian</a></li>
<li class="chapter" data-level="4.3" data-path="basic-stat-concepts.html"><a href="basic-stat-concepts.html#hessian-and-fisher-information"><i class="fa fa-check"></i><b>4.3</b> Hessian and Fisher Information</a></li>
<li class="chapter" data-level="4.4" data-path="basic-stat-concepts.html"><a href="basic-stat-concepts.html#canonical-link-function"><i class="fa fa-check"></i><b>4.4</b> Canonical link function</a></li>
<li class="chapter" data-level="4.5" data-path="basic-stat-concepts.html"><a href="basic-stat-concepts.html#ordinary-least-squares-ols"><i class="fa fa-check"></i><b>4.5</b> Ordinary Least Squares (OLS)</a></li>
<li class="chapter" data-level="4.6" data-path="basic-stat-concepts.html"><a href="basic-stat-concepts.html#taylor-series"><i class="fa fa-check"></i><b>4.6</b> Taylor series</a></li>
<li class="chapter" data-level="4.7" data-path="basic-stat-concepts.html"><a href="basic-stat-concepts.html#fisher-scoring"><i class="fa fa-check"></i><b>4.7</b> Fisher scoring</a></li>
<li class="chapter" data-level="4.8" data-path="basic-stat-concepts.html"><a href="basic-stat-concepts.html#references-1"><i class="fa fa-check"></i><b>4.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-r.html"><a href="basic-r.html"><i class="fa fa-check"></i><b>5</b> Basic R</a><ul>
<li class="chapter" data-level="5.1" data-path="basic-r.html"><a href="basic-r.html#apply-lapply-sapply"><i class="fa fa-check"></i><b>5.1</b> apply, lapply, sapply</a><ul>
<li class="chapter" data-level="5.1.1" data-path="basic-r.html"><a href="basic-r.html#apply"><i class="fa fa-check"></i><b>5.1.1</b> apply</a></li>
<li class="chapter" data-level="5.1.2" data-path="basic-r.html"><a href="basic-r.html#lapply"><i class="fa fa-check"></i><b>5.1.2</b> lapply</a></li>
<li class="chapter" data-level="5.1.3" data-path="basic-r.html"><a href="basic-r.html#sapply"><i class="fa fa-check"></i><b>5.1.3</b> sapply</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="basic-r.html"><a href="basic-r.html#c"><i class="fa fa-check"></i><b>5.2</b> C</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="computing-techniques.html"><a href="computing-techniques.html"><i class="fa fa-check"></i><b>6</b> Computing Techniques</a><ul>
<li class="chapter" data-level="6.1" data-path="computing-techniques.html"><a href="computing-techniques.html#monte-carlo-approximation"><i class="fa fa-check"></i><b>6.1</b> Monte carlo approximation</a></li>
<li class="chapter" data-level="6.2" data-path="computing-techniques.html"><a href="computing-techniques.html#importance-sampling"><i class="fa fa-check"></i><b>6.2</b> Importance sampling</a></li>
<li class="chapter" data-level="6.3" data-path="computing-techniques.html"><a href="computing-techniques.html#newton-raphson-algorithm"><i class="fa fa-check"></i><b>6.3</b> Newton Raphson algorithm</a><ul>
<li class="chapter" data-level="6.3.1" data-path="computing-techniques.html"><a href="computing-techniques.html#calculate-the-root"><i class="fa fa-check"></i><b>6.3.1</b> Calculate the root</a></li>
<li class="chapter" data-level="6.3.2" data-path="computing-techniques.html"><a href="computing-techniques.html#logistic-regression"><i class="fa fa-check"></i><b>6.3.2</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="computing-techniques.html"><a href="computing-techniques.html#metropolis-hastings"><i class="fa fa-check"></i><b>6.4</b> Metropolis Hastings</a></li>
<li class="chapter" data-level="6.5" data-path="computing-techniques.html"><a href="computing-techniques.html#em"><i class="fa fa-check"></i><b>6.5</b> EM</a></li>
<li class="chapter" data-level="6.6" data-path="computing-techniques.html"><a href="computing-techniques.html#references-2"><i class="fa fa-check"></i><b>6.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="generalized-linear-mixed-models.html"><a href="generalized-linear-mixed-models.html"><i class="fa fa-check"></i><b>7</b> Generalized Linear Mixed Models</a><ul>
<li class="chapter" data-level="7.1" data-path="generalized-linear-mixed-models.html"><a href="generalized-linear-mixed-models.html#basics-of-glmm"><i class="fa fa-check"></i><b>7.1</b> Basics of GLMM</a></li>
<li class="chapter" data-level="7.2" data-path="generalized-linear-mixed-models.html"><a href="generalized-linear-mixed-models.html#some-references"><i class="fa fa-check"></i><b>7.2</b> Some References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="twitter-example.html"><a href="twitter-example.html"><i class="fa fa-check"></i><b>8</b> Twitter Example</a><ul>
<li class="chapter" data-level="8.1" data-path="twitter-example.html"><a href="twitter-example.html#model"><i class="fa fa-check"></i><b>8.1</b> Model</a></li>
<li class="chapter" data-level="8.2" data-path="twitter-example.html"><a href="twitter-example.html#simulating-data-of-senators-on-twitter"><i class="fa fa-check"></i><b>8.2</b> Simulating Data of Senators on Twitter</a></li>
<li class="chapter" data-level="8.3" data-path="twitter-example.html"><a href="twitter-example.html#simulating-data-of-conservative-users-on-twitter-and-model-testing"><i class="fa fa-check"></i><b>8.3</b> Simulating Data of Conservative Users on Twitter and Model Testing</a></li>
<li class="chapter" data-level="8.4" data-path="twitter-example.html"><a href="twitter-example.html#simulating-data-of-liberal-users-on-twitter-and-model-testing"><i class="fa fa-check"></i><b>8.4</b> Simulating Data of Liberal Users on Twitter and Model Testing</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="practice-learning-on-the-battle-field.html"><a href="practice-learning-on-the-battle-field.html"><i class="fa fa-check"></i><b>9</b> Practice: Learning on the Battle Field</a><ul>
<li class="chapter" data-level="9.1" data-path="practice-learning-on-the-battle-field.html"><a href="practice-learning-on-the-battle-field.html#r-code"><i class="fa fa-check"></i><b>9.1</b> R code</a></li>
<li class="chapter" data-level="9.2" data-path="practice-learning-on-the-battle-field.html"><a href="practice-learning-on-the-battle-field.html#references-3"><i class="fa fa-check"></i><b>9.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="project-draft.html"><a href="project-draft.html"><i class="fa fa-check"></i><b>10</b> Project Draft</a><ul>
<li class="chapter" data-level="10.1" data-path="project-draft.html"><a href="project-draft.html#background"><i class="fa fa-check"></i><b>10.1</b> Background</a></li>
<li class="chapter" data-level="10.2" data-path="project-draft.html"><a href="project-draft.html#important-examples-with-r-code"><i class="fa fa-check"></i><b>10.2</b> Important Examples with R code</a></li>
<li class="chapter" data-level="10.3" data-path="project-draft.html"><a href="project-draft.html#references-4"><i class="fa fa-check"></i><b>10.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i><b>11</b> Bayesian</a><ul>
<li class="chapter" data-level="11.1" data-path="bayesian.html"><a href="bayesian.html#frequentist-perspective"><i class="fa fa-check"></i><b>11.1</b> Frequentist perspective</a></li>
<li class="chapter" data-level="11.2" data-path="bayesian.html"><a href="bayesian.html#bayesian-perspective"><i class="fa fa-check"></i><b>11.2</b> Bayesian perspective</a></li>
<li class="chapter" data-level="11.3" data-path="bayesian.html"><a href="bayesian.html#continous-parameters"><i class="fa fa-check"></i><b>11.3</b> Continous parameters</a><ul>
<li class="chapter" data-level="11.3.1" data-path="bayesian.html"><a href="bayesian.html#uniform"><i class="fa fa-check"></i><b>11.3.1</b> Uniform</a></li>
<li class="chapter" data-level="11.3.2" data-path="bayesian.html"><a href="bayesian.html#uniform-prior-versus-posterior"><i class="fa fa-check"></i><b>11.3.2</b> Uniform: prior versus posterior</a></li>
<li class="chapter" data-level="11.3.3" data-path="bayesian.html"><a href="bayesian.html#uniform-equal-tailed-versus-hpd"><i class="fa fa-check"></i><b>11.3.3</b> Uniform: equal tailed versus HPD</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="bayesian.html"><a href="bayesian.html#bernoullibinomial-likelihood-with-uniform-prior"><i class="fa fa-check"></i><b>11.4</b> Bernoulli/binomial likelihood with uniform prior</a></li>
<li class="chapter" data-level="11.5" data-path="bayesian.html"><a href="bayesian.html#conjugate-priors"><i class="fa fa-check"></i><b>11.5</b> Conjugate priors</a></li>
<li class="chapter" data-level="11.6" data-path="bayesian.html"><a href="bayesian.html#poisson-distribution"><i class="fa fa-check"></i><b>11.6</b> Poisson distribution</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="trying.html"><a href="trying.html"><i class="fa fa-check"></i><b>12</b> Trying</a><ul>
<li class="chapter" data-level="12.1" data-path="trying.html"><a href="trying.html#the-basic-idea"><i class="fa fa-check"></i><b>12.1</b> The Basic Idea</a></li>
<li class="chapter" data-level="12.2" data-path="trying.html"><a href="trying.html#model-and-r-code"><i class="fa fa-check"></i><b>12.2</b> Model and R Code</a></li>
<li class="chapter" data-level="12.3" data-path="trying.html"><a href="trying.html#glmmtmb-package"><i class="fa fa-check"></i><b>12.3</b> glmmTMB package</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.williamsding.com/" target="blank">Bill's website</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GLMM, Concepts, &amp; R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trying" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> Trying</h1>
<div id="the-basic-idea" class="section level2">
<h2><span class="header-section-number">12.1</span> The Basic Idea</h2>
<p><span class="math display">\[L(\beta,D|Y)=\int \prod_{i=1}^{n} f_{y_i|u}(y_i|b,\beta)f_{b_i}(b_i|D)db_i\]</span></p>
<p>Notations :</p>
<p><span class="math inline">\(y\)</span>: Variable for the fixed effect</p>
<p><span class="math inline">\(b\)</span>: Variable for the random effect</p>
<p><span class="math inline">\(\beta\)</span>: Parameters for the fixed effect</p>
<p><span class="math inline">\(D\)</span>: Parameters for the random effect</p>
<p>The dimension of the integral is equal to the levels of the random factors (i.e., the number of observations).</p>
</div>
<div id="model-and-r-code" class="section level2">
<h2><span class="header-section-number">12.2</span> Model and R Code</h2>
<p>Covarance Matrix for <span class="math inline">\(n\)</span> observations:</p>
<p><span class="math display">\[V=\sigma^2 \begin{bmatrix} 1 &amp; \rho &amp; \rho^2 &amp; ... &amp; \rho^{n-1} &amp; \rho^n \\ \rho &amp; 1 &amp; \rho &amp; ... &amp; \rho^{n-2}&amp; \rho^{n-1}\\ \rho^2 &amp; \rho &amp; 1 &amp; ... &amp; \rho^{n-3}&amp; \rho^{n-2} \\ ...\\ \rho^n &amp; \rho^{n-1} &amp; \rho^{n-2} &amp; ... &amp; \rho &amp; 1 \end{bmatrix}\]</span></p>
<p>The inverse matrix is as follows:</p>
<p><span class="math display">\[Q=V^{-1}=\frac{1}{\sigma^2(1-\rho)} \begin{bmatrix} 1 &amp; -\rho &amp; 0 &amp; ... &amp; 0 &amp; 0 \\ -\rho &amp; 1+\rho^2 &amp; -\rho &amp; ... &amp; 0 &amp; 0\\ 0 &amp; -\rho &amp; 1+\rho^2 &amp; ... &amp; 0 &amp; 0 \\ ...\\ 0 &amp; 0 &amp; 0 &amp; ... &amp; 1+\rho^2 &amp;-\rho\\ 0 &amp; 0 &amp; 0 &amp; ... &amp; -\rho &amp; 1 \end{bmatrix}\]</span></p>
<p><span class="math display">\[N(-\sum_{j\neq k} Q_{kj}b_j^{(m)}Q_{kk}^{-1},Q_{kk}^{-1})\]</span>
<span class="math display">\[ln L(\beta, \theta; Y,b)=\ell=lnf_{Y|b}(Y|b,\beta)+lnf_b(b|\theta)\]</span></p>
<p><span class="math display">\[a^{(m+1)}=a^{(m)}+\tau(a^{(m)})^{-1} S(a^{(m)})\]</span>
Where,</p>
<p><span class="math display">\[\tau(a) = -E(\frac{\partial^2 \ell}{\partial \alpha \partial \alpha^{&#39;}}|Y)\]</span></p>
<p><span class="math display">\[S(a) = E(\frac{\partial \ell}{\partial \alpha }|Y)\]</span>
Note that, <span class="math inline">\(\alpha\)</span> is a combination of two sets of parameters.</p>
<p><span class="math display">\[\alpha = \binom{\beta}{b} \]</span></p>
<p><span class="math display">\[\ell=\sum_{i=1}^{n}\{[y_i ln (\frac{e^{\beta^Tx_i+b_i}}{1+e^{\beta^Tx_i+b_i}}) + (1-y_i) ln(1-\frac{e^{\beta^Tx_i+b_i}}{1+e^{\beta^Tx_i+b_i}})]+lnf_b(b_i|\theta)\}\]</span></p>
<p><span class="math display">\[\frac{\partial lnf(Y|b, \beta)}{\partial \beta}=X^{&#39;}(Y-E(Y|b))\]</span></p>
<p><span class="math display">\[\frac{\partial lnf(Y|b, \beta)}{\partial \beta \partial \beta^{&#39;}}=-X^{&#39;}(Y-E(Y|b))\]</span></p>
<p><span class="math display">\[\begin{aligned} \nabla \ell &amp;= \sum_{i=1}^{n} [y_i \frac{1}{p(\beta ^T x_i+b_i)} \frac{\partial p(\beta ^T x_i+b_i)}{\partial (\beta ^T x_i+b_i)}\frac{\partial (\beta ^T x_i+b_i)}{\partial \beta}+(1-y_i) \frac{1}{1-p(\beta ^T x_i+b_i)}(-1)\frac{\partial p(\beta ^T x_i+b_i)}{\partial (\beta ^T x_i+b_i)}\frac{\partial (\beta ^T x_i+b_i)}{\partial \beta}] \\ &amp;=\sum_{i=1}^{n} x_i^T[y_i-p(\beta ^T x_i+b_i)] \\ &amp;= \sum_{i=1}^{n} x_i^T[y_i-\frac{e^{\beta^Tx_i+b_i}}{1+e^{\beta^Tx_i+b_i}}] \end{aligned}\]</span></p>
<p>The Newton Raphson algorithm needs the second order.</p>
<p><span class="math display">\[\begin{aligned} \nabla^2 \ell &amp;=\frac{\partial \sum_{i=1}^{n} x_i^T[y_i-p(\beta ^T x_i+b_i)]}{\partial \beta} \\ &amp;=-\sum_{i=1}^{n} x_i^T\frac{\partial p(\beta ^T x_i+b_i) }{\partial \beta}\\ &amp;=-\sum_{i=1}^{n} x_i^T\frac{\partial p(\beta ^T x_i+b_i) }{\partial (\beta^Tx_i+b_i)} \frac{\partial (\beta^Tx_i+b_i)}{\partial \beta}\\ &amp;=-\sum_{i=1}^{n} x_i^T p(\beta ^T x_i+b_i)(1-p(\beta ^T x_i+b_i))x_i \\ &amp;=-\sum_{i=1}^{n} x_i^T \frac{e^{\beta^Tx_i+b_i}}{1+e^{\beta^Tx_i+b_i}}(1-\frac{e^{\beta^Tx_i+b_i}}{1+e^{\beta^Tx_i+b_i}})x_i \end{aligned}\]</span>
Using the Newton Raphson, the following code calculates the basic logistic model, without any random effects. As we can see, it produces the same result as the R generic function of GLM. Note that, the function of Expit and the variables of y and are from the last block of R code.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1">x_intercept&lt;-<span class="kw">rep</span>(<span class="dv">1</span>,n)</a>
<a class="sourceLine" id="cb141-2" title="2">x_intercept&lt;-<span class="kw">as.matrix</span>(x_intercept)</a>
<a class="sourceLine" id="cb141-3" title="3"></a>
<a class="sourceLine" id="cb141-4" title="4">tolerance=<span class="fl">1e-3</span></a>
<a class="sourceLine" id="cb141-5" title="5">max_its=<span class="dv">2000</span>;iteration=<span class="dv">1</span>;difference=<span class="dv">2</span></a>
<a class="sourceLine" id="cb141-6" title="6">W&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,n,n)</a>
<a class="sourceLine" id="cb141-7" title="7">beta_old&lt;-<span class="fl">0.4</span></a>
<a class="sourceLine" id="cb141-8" title="8"></a>
<a class="sourceLine" id="cb141-9" title="9"><span class="cf">while</span>(difference<span class="op">&gt;</span>tolerance <span class="op">&amp;</span><span class="st"> </span>iteration<span class="op">&lt;</span>max_its)</a>
<a class="sourceLine" id="cb141-10" title="10">  {</a>
<a class="sourceLine" id="cb141-11" title="11">  <span class="co"># The first order</span></a>
<a class="sourceLine" id="cb141-12" title="12">  f_firstorder&lt;-<span class="kw">t</span>(x_intercept)<span class="op">%*%</span>(y<span class="op">-</span><span class="kw">Expit</span>(x_intercept<span class="op">%*%</span>beta_old))</a>
<a class="sourceLine" id="cb141-13" title="13">  </a>
<a class="sourceLine" id="cb141-14" title="14">  <span class="co"># The second order</span></a>
<a class="sourceLine" id="cb141-15" title="15">  <span class="kw">diag</span>(W) =<span class="st"> </span><span class="kw">Expit</span>(x_intercept<span class="op">%*%</span>beta_old)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">Expit</span>(x_intercept<span class="op">%*%</span>beta_old))</a>
<a class="sourceLine" id="cb141-16" title="16">  </a>
<a class="sourceLine" id="cb141-17" title="17">  f_secondorder&lt;-<span class="op">-</span><span class="kw">t</span>(x_intercept)<span class="op">%*%</span>W<span class="op">%*%</span>x_intercept</a>
<a class="sourceLine" id="cb141-18" title="18">  </a>
<a class="sourceLine" id="cb141-19" title="19">  <span class="co"># Calculate the beta_updated</span></a>
<a class="sourceLine" id="cb141-20" title="20">  beta_updated=beta_old<span class="op">-</span>(<span class="kw">solve</span>(f_secondorder)<span class="op">%*%</span>f_firstorder)</a>
<a class="sourceLine" id="cb141-21" title="21">  </a>
<a class="sourceLine" id="cb141-22" title="22">  difference=<span class="kw">max</span>(<span class="kw">abs</span>(beta_updated<span class="op">-</span>beta_old));</a>
<a class="sourceLine" id="cb141-23" title="23">  </a>
<a class="sourceLine" id="cb141-24" title="24">  iteration=iteration<span class="op">+</span><span class="dv">1</span>;</a>
<a class="sourceLine" id="cb141-25" title="25">  </a>
<a class="sourceLine" id="cb141-26" title="26">  beta_old=beta_updated}</a>
<a class="sourceLine" id="cb141-27" title="27"></a>
<a class="sourceLine" id="cb141-28" title="28">beta_old</a></code></pre></div>
<pre><code>##          [,1]
## [1,] 1.643422</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">glm</span>(y<span class="op">~</span><span class="dv">1</span>, <span class="dt">family=</span>binomial)<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>## (Intercept) 
##    1.643422</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="co">#install.packages(&quot;CVTuningCov&quot;)</span></a>
<a class="sourceLine" id="cb145-2" title="2"><span class="kw">library</span>(CVTuningCov) <span class="co"># Will be used to generate AR1 matrix</span></a>
<a class="sourceLine" id="cb145-3" title="3"></a>
<a class="sourceLine" id="cb145-4" title="4"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb145-5" title="5">y&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>) <span class="co">## observations</span></a>
<a class="sourceLine" id="cb145-6" title="6"></a>
<a class="sourceLine" id="cb145-7" title="7">n=<span class="kw">length</span>(y) <span class="co"># the number of observations</span></a>
<a class="sourceLine" id="cb145-8" title="8"></a>
<a class="sourceLine" id="cb145-9" title="9"></a>
<a class="sourceLine" id="cb145-10" title="10"><span class="co">#Establish the exp function</span></a>
<a class="sourceLine" id="cb145-11" title="11">Expit&lt;-<span class="cf">function</span>(x){<span class="kw">exp</span>(x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">exp</span>(x))}</a>
<a class="sourceLine" id="cb145-12" title="12"><span class="co">#Y: observations</span></a>
<a class="sourceLine" id="cb145-13" title="13"><span class="co">#b: random effect</span></a>
<a class="sourceLine" id="cb145-14" title="14"><span class="co">#beta_0:fixed effect-&gt;intercept (or, mean of Y)</span></a>
<a class="sourceLine" id="cb145-15" title="15"></a>
<a class="sourceLine" id="cb145-16" title="16">log_pdf_function&lt;-<span class="cf">function</span>(Y,b,beta_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb145-17" title="17">  {mean_prob&lt;-<span class="kw">Expit</span>(beta_<span class="dv">0</span><span class="op">+</span>b)</a>
<a class="sourceLine" id="cb145-18" title="18">  <span class="kw">dbinom</span>(Y,<span class="dv">1</span>,mean_prob,<span class="dt">log =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb145-19" title="19">  }</a>
<a class="sourceLine" id="cb145-20" title="20"></a>
<a class="sourceLine" id="cb145-21" title="21">b_records&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,n)  <span class="co">#Initial values for the random effect</span></a>
<a class="sourceLine" id="cb145-22" title="22">rho_records&lt;-<span class="fl">0.5</span> <span class="co">#Initial value for rho</span></a>
<a class="sourceLine" id="cb145-23" title="23">sigma_recoards&lt;-<span class="dv">2</span>  <span class="co">#Initial value for sigma</span></a>
<a class="sourceLine" id="cb145-24" title="24">mean_<span class="dv">0</span>&lt;-<span class="dv">0</span> <span class="co"># Initial mean value for normal distribution (of the random effect)</span></a>
<a class="sourceLine" id="cb145-25" title="25">beta&lt;-<span class="fl">0.5</span> <span class="co"># Initial value for the intercept of Y</span></a>
<a class="sourceLine" id="cb145-26" title="26"></a>
<a class="sourceLine" id="cb145-27" title="27"></a>
<a class="sourceLine" id="cb145-28" title="28">f_random&lt;-<span class="cf">function</span>(sigma_recoards, rho_records,beta)</a>
<a class="sourceLine" id="cb145-29" title="29">{</a>
<a class="sourceLine" id="cb145-30" title="30">  </a>
<a class="sourceLine" id="cb145-31" title="31">co_matrix&lt;-(sigma_recoards<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">AR1</span>(n,rho_records) <span class="co"># covariance matrix</span></a>
<a class="sourceLine" id="cb145-32" title="32">co_matrix_inverse&lt;-<span class="kw">solve</span>(co_matrix)  <span class="co"># inverse covariance matrix</span></a>
<a class="sourceLine" id="cb145-33" title="33"></a>
<a class="sourceLine" id="cb145-34" title="34"></a>
<a class="sourceLine" id="cb145-35" title="35"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb145-36" title="36"> {</a>
<a class="sourceLine" id="cb145-37" title="37">  <span class="co"># Variance for the random effect</span></a>
<a class="sourceLine" id="cb145-38" title="38">  sd_<span class="dv">0</span>&lt;-<span class="dv">1</span><span class="op">/</span>(co_matrix_inverse[k,k])</a>
<a class="sourceLine" id="cb145-39" title="39">  </a>
<a class="sourceLine" id="cb145-40" title="40">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb145-41" title="41">      { <span class="co"># Make sure that k is not equal to j, otherwise 0</span></a>
<a class="sourceLine" id="cb145-42" title="42">        Q_kj&lt;-<span class="kw">ifelse</span>(j<span class="op">!=</span>k,co_matrix_inverse[k,j],<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb145-43" title="43">        <span class="co"># Calculate the mean for the random effect; sum of mean in a loop</span></a>
<a class="sourceLine" id="cb145-44" title="44">        mean_<span class="dv">0</span>&lt;-mean_<span class="dv">0</span><span class="op">-</span>(Q_kj<span class="op">/</span>co_matrix_inverse[k,k])<span class="op">*</span>b_records[j]</a>
<a class="sourceLine" id="cb145-45" title="45">      }</a>
<a class="sourceLine" id="cb145-46" title="46">  <span class="co"># Draw a random number from the normal distribution for the random effect</span></a>
<a class="sourceLine" id="cb145-47" title="47">  b_candidate&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,mean_<span class="dv">0</span>,sd_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb145-48" title="48">  </a>
<a class="sourceLine" id="cb145-49" title="49">  current_lp&lt;-<span class="kw">log_pdf_function</span>(y[k],b_records[k],beta)</a>
<a class="sourceLine" id="cb145-50" title="50">  candidate_lp&lt;-<span class="kw">log_pdf_function</span>(y[k],b_candidate,beta)</a>
<a class="sourceLine" id="cb145-51" title="51">  </a>
<a class="sourceLine" id="cb145-52" title="52">  Smaller_value&lt;-<span class="kw">min</span>(<span class="kw">exp</span>(candidate_lp<span class="op">-</span>current_lp),<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb145-53" title="53">  <span class="co"># Draw a random number from the uniform distribution</span></a>
<a class="sourceLine" id="cb145-54" title="54">  Random_probability&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb145-55" title="55">  <span class="co"># Update b (i.e., random variable)</span></a>
<a class="sourceLine" id="cb145-56" title="56">  b_records[k]&lt;-<span class="kw">ifelse</span>(Random_probability<span class="op">&lt;</span>Smaller_value,b_candidate,b_records[k])</a>
<a class="sourceLine" id="cb145-57" title="57">}</a>
<a class="sourceLine" id="cb145-58" title="58"></a>
<a class="sourceLine" id="cb145-59" title="59"><span class="kw">return</span>(b_records)</a>
<a class="sourceLine" id="cb145-60" title="60">}</a>
<a class="sourceLine" id="cb145-61" title="61"></a>
<a class="sourceLine" id="cb145-62" title="62"><span class="co"># Print result</span></a>
<a class="sourceLine" id="cb145-63" title="63"><span class="co">#b_records&lt;-f_random(1,0.8,0.3) </span></a></code></pre></div>
<p>In the following, I will try to add the random effect.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1">x_intercept&lt;-<span class="kw">rep</span>(<span class="dv">1</span>,n)</a>
<a class="sourceLine" id="cb146-2" title="2">x_intercept&lt;-<span class="kw">as.matrix</span>(x_intercept)</a>
<a class="sourceLine" id="cb146-3" title="3"></a>
<a class="sourceLine" id="cb146-4" title="4"><span class="co">#We need to set random starting values.</span></a>
<a class="sourceLine" id="cb146-5" title="5"></a>
<a class="sourceLine" id="cb146-6" title="6">tolerance=<span class="fl">1e-3</span></a>
<a class="sourceLine" id="cb146-7" title="7">max_its=<span class="dv">2000</span>;iteration=<span class="dv">1</span>;difference=<span class="dv">2</span></a>
<a class="sourceLine" id="cb146-8" title="8">W&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,n,n)</a>
<a class="sourceLine" id="cb146-9" title="9">beta_old&lt;-<span class="fl">0.4</span></a>
<a class="sourceLine" id="cb146-10" title="10"></a>
<a class="sourceLine" id="cb146-11" title="11"><span class="cf">while</span>(difference<span class="op">&gt;</span>tolerance <span class="op">&amp;</span><span class="st"> </span>iteration<span class="op">&lt;</span>max_its)</a>
<a class="sourceLine" id="cb146-12" title="12">  {</a>
<a class="sourceLine" id="cb146-13" title="13">  b_records&lt;-<span class="kw">f_random</span>(<span class="dv">2</span>,<span class="fl">0.9</span>,beta_old)</a>
<a class="sourceLine" id="cb146-14" title="14">  <span class="kw">print</span>(<span class="st">&quot;first&quot;</span>)</a>
<a class="sourceLine" id="cb146-15" title="15">  <span class="kw">print</span>(beta_old)</a>
<a class="sourceLine" id="cb146-16" title="16">  <span class="kw">print</span>(b_records)</a>
<a class="sourceLine" id="cb146-17" title="17">  <span class="co"># The first order</span></a>
<a class="sourceLine" id="cb146-18" title="18">  f_firstorder&lt;-<span class="kw">t</span>(x_intercept)<span class="op">%*%</span>(y<span class="op">-</span><span class="kw">Expit</span>(x_intercept<span class="op">%*%</span>beta_old<span class="op">+</span>b_records))</a>
<a class="sourceLine" id="cb146-19" title="19">  <span class="kw">print</span>(f_firstorder)</a>
<a class="sourceLine" id="cb146-20" title="20">  <span class="co"># The second order</span></a>
<a class="sourceLine" id="cb146-21" title="21">  <span class="kw">diag</span>(W) =<span class="st"> </span><span class="kw">Expit</span>(x_intercept<span class="op">%*%</span>beta_old<span class="op">+</span>b_records)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">Expit</span>(x_intercept<span class="op">%*%</span>beta_old<span class="op">+</span>b_records))</a>
<a class="sourceLine" id="cb146-22" title="22">  </a>
<a class="sourceLine" id="cb146-23" title="23">  f_secondorder&lt;-<span class="op">-</span><span class="kw">t</span>(x_intercept)<span class="op">%*%</span>W<span class="op">%*%</span>x_intercept</a>
<a class="sourceLine" id="cb146-24" title="24">  </a>
<a class="sourceLine" id="cb146-25" title="25">  <span class="co"># Calculate the beta_updated</span></a>
<a class="sourceLine" id="cb146-26" title="26">  beta_updated=beta_old<span class="op">-</span>(<span class="kw">solve</span>(f_secondorder)<span class="op">%*%</span>f_firstorder)</a>
<a class="sourceLine" id="cb146-27" title="27">  </a>
<a class="sourceLine" id="cb146-28" title="28">  difference=<span class="kw">max</span>(<span class="kw">abs</span>(beta_updated<span class="op">-</span>beta_old));</a>
<a class="sourceLine" id="cb146-29" title="29">  </a>
<a class="sourceLine" id="cb146-30" title="30">  iteration=iteration<span class="op">+</span><span class="dv">1</span>;</a>
<a class="sourceLine" id="cb146-31" title="31">  </a>
<a class="sourceLine" id="cb146-32" title="32">  beta_old=beta_updated</a>
<a class="sourceLine" id="cb146-33" title="33">  }</a>
<a class="sourceLine" id="cb146-34" title="34"></a>
<a class="sourceLine" id="cb146-35" title="35">beta_old</a></code></pre></div>
</div>
<div id="glmmtmb-package" class="section level2">
<h2><span class="header-section-number">12.3</span> glmmTMB package</h2>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="co"># https://becarioprecario.bitbucket.io/inla-gitbook/ch-intro.html</span></a>
<a class="sourceLine" id="cb147-2" title="2"><span class="co">#https://cran.r-project.org/web/packages/glmmTMB/vignettes/covstruct.html</span></a>
<a class="sourceLine" id="cb147-3" title="3"><span class="co">#install.packages(&quot;glmmTMB&quot;)</span></a>
<a class="sourceLine" id="cb147-4" title="4"><span class="kw">library</span>(glmmTMB)</a></code></pre></div>
<pre><code>## Warning: package &#39;glmmTMB&#39; was built under R version 3.6.2</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">times &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb149-2" title="2"><span class="kw">levels</span>(times)</a></code></pre></div>
<pre><code>##    [1] &quot;1&quot;    &quot;2&quot;    &quot;3&quot;    &quot;4&quot;    &quot;5&quot;    &quot;6&quot;    &quot;7&quot;    &quot;8&quot;    &quot;9&quot;   
##   [10] &quot;10&quot;   &quot;11&quot;   &quot;12&quot;   &quot;13&quot;   &quot;14&quot;   &quot;15&quot;   &quot;16&quot;   &quot;17&quot;   &quot;18&quot;  
##   [19] &quot;19&quot;   &quot;20&quot;   &quot;21&quot;   &quot;22&quot;   &quot;23&quot;   &quot;24&quot;   &quot;25&quot;   &quot;26&quot;   &quot;27&quot;  
##   [28] &quot;28&quot;   &quot;29&quot;   &quot;30&quot;   &quot;31&quot;   &quot;32&quot;   &quot;33&quot;   &quot;34&quot;   &quot;35&quot;   &quot;36&quot;  
##   [37] &quot;37&quot;   &quot;38&quot;   &quot;39&quot;   &quot;40&quot;   &quot;41&quot;   &quot;42&quot;   &quot;43&quot;   &quot;44&quot;   &quot;45&quot;  
##   [46] &quot;46&quot;   &quot;47&quot;   &quot;48&quot;   &quot;49&quot;   &quot;50&quot;   &quot;51&quot;   &quot;52&quot;   &quot;53&quot;   &quot;54&quot;  
##   [55] &quot;55&quot;   &quot;56&quot;   &quot;57&quot;   &quot;58&quot;   &quot;59&quot;   &quot;60&quot;   &quot;61&quot;   &quot;62&quot;   &quot;63&quot;  
##   [64] &quot;64&quot;   &quot;65&quot;   &quot;66&quot;   &quot;67&quot;   &quot;68&quot;   &quot;69&quot;   &quot;70&quot;   &quot;71&quot;   &quot;72&quot;  
##   [73] &quot;73&quot;   &quot;74&quot;   &quot;75&quot;   &quot;76&quot;   &quot;77&quot;   &quot;78&quot;   &quot;79&quot;   &quot;80&quot;   &quot;81&quot;  
##   [82] &quot;82&quot;   &quot;83&quot;   &quot;84&quot;   &quot;85&quot;   &quot;86&quot;   &quot;87&quot;   &quot;88&quot;   &quot;89&quot;   &quot;90&quot;  
##   [91] &quot;91&quot;   &quot;92&quot;   &quot;93&quot;   &quot;94&quot;   &quot;95&quot;   &quot;96&quot;   &quot;97&quot;   &quot;98&quot;   &quot;99&quot;  
##  [100] &quot;100&quot;  &quot;101&quot;  &quot;102&quot;  &quot;103&quot;  &quot;104&quot;  &quot;105&quot;  &quot;106&quot;  &quot;107&quot;  &quot;108&quot; 
##  [109] &quot;109&quot;  &quot;110&quot;  &quot;111&quot;  &quot;112&quot;  &quot;113&quot;  &quot;114&quot;  &quot;115&quot;  &quot;116&quot;  &quot;117&quot; 
##  [118] &quot;118&quot;  &quot;119&quot;  &quot;120&quot;  &quot;121&quot;  &quot;122&quot;  &quot;123&quot;  &quot;124&quot;  &quot;125&quot;  &quot;126&quot; 
##  [127] &quot;127&quot;  &quot;128&quot;  &quot;129&quot;  &quot;130&quot;  &quot;131&quot;  &quot;132&quot;  &quot;133&quot;  &quot;134&quot;  &quot;135&quot; 
##  [136] &quot;136&quot;  &quot;137&quot;  &quot;138&quot;  &quot;139&quot;  &quot;140&quot;  &quot;141&quot;  &quot;142&quot;  &quot;143&quot;  &quot;144&quot; 
##  [145] &quot;145&quot;  &quot;146&quot;  &quot;147&quot;  &quot;148&quot;  &quot;149&quot;  &quot;150&quot;  &quot;151&quot;  &quot;152&quot;  &quot;153&quot; 
##  [154] &quot;154&quot;  &quot;155&quot;  &quot;156&quot;  &quot;157&quot;  &quot;158&quot;  &quot;159&quot;  &quot;160&quot;  &quot;161&quot;  &quot;162&quot; 
##  [163] &quot;163&quot;  &quot;164&quot;  &quot;165&quot;  &quot;166&quot;  &quot;167&quot;  &quot;168&quot;  &quot;169&quot;  &quot;170&quot;  &quot;171&quot; 
##  [172] &quot;172&quot;  &quot;173&quot;  &quot;174&quot;  &quot;175&quot;  &quot;176&quot;  &quot;177&quot;  &quot;178&quot;  &quot;179&quot;  &quot;180&quot; 
##  [181] &quot;181&quot;  &quot;182&quot;  &quot;183&quot;  &quot;184&quot;  &quot;185&quot;  &quot;186&quot;  &quot;187&quot;  &quot;188&quot;  &quot;189&quot; 
##  [190] &quot;190&quot;  &quot;191&quot;  &quot;192&quot;  &quot;193&quot;  &quot;194&quot;  &quot;195&quot;  &quot;196&quot;  &quot;197&quot;  &quot;198&quot; 
##  [199] &quot;199&quot;  &quot;200&quot;  &quot;201&quot;  &quot;202&quot;  &quot;203&quot;  &quot;204&quot;  &quot;205&quot;  &quot;206&quot;  &quot;207&quot; 
##  [208] &quot;208&quot;  &quot;209&quot;  &quot;210&quot;  &quot;211&quot;  &quot;212&quot;  &quot;213&quot;  &quot;214&quot;  &quot;215&quot;  &quot;216&quot; 
##  [217] &quot;217&quot;  &quot;218&quot;  &quot;219&quot;  &quot;220&quot;  &quot;221&quot;  &quot;222&quot;  &quot;223&quot;  &quot;224&quot;  &quot;225&quot; 
##  [226] &quot;226&quot;  &quot;227&quot;  &quot;228&quot;  &quot;229&quot;  &quot;230&quot;  &quot;231&quot;  &quot;232&quot;  &quot;233&quot;  &quot;234&quot; 
##  [235] &quot;235&quot;  &quot;236&quot;  &quot;237&quot;  &quot;238&quot;  &quot;239&quot;  &quot;240&quot;  &quot;241&quot;  &quot;242&quot;  &quot;243&quot; 
##  [244] &quot;244&quot;  &quot;245&quot;  &quot;246&quot;  &quot;247&quot;  &quot;248&quot;  &quot;249&quot;  &quot;250&quot;  &quot;251&quot;  &quot;252&quot; 
##  [253] &quot;253&quot;  &quot;254&quot;  &quot;255&quot;  &quot;256&quot;  &quot;257&quot;  &quot;258&quot;  &quot;259&quot;  &quot;260&quot;  &quot;261&quot; 
##  [262] &quot;262&quot;  &quot;263&quot;  &quot;264&quot;  &quot;265&quot;  &quot;266&quot;  &quot;267&quot;  &quot;268&quot;  &quot;269&quot;  &quot;270&quot; 
##  [271] &quot;271&quot;  &quot;272&quot;  &quot;273&quot;  &quot;274&quot;  &quot;275&quot;  &quot;276&quot;  &quot;277&quot;  &quot;278&quot;  &quot;279&quot; 
##  [280] &quot;280&quot;  &quot;281&quot;  &quot;282&quot;  &quot;283&quot;  &quot;284&quot;  &quot;285&quot;  &quot;286&quot;  &quot;287&quot;  &quot;288&quot; 
##  [289] &quot;289&quot;  &quot;290&quot;  &quot;291&quot;  &quot;292&quot;  &quot;293&quot;  &quot;294&quot;  &quot;295&quot;  &quot;296&quot;  &quot;297&quot; 
##  [298] &quot;298&quot;  &quot;299&quot;  &quot;300&quot;  &quot;301&quot;  &quot;302&quot;  &quot;303&quot;  &quot;304&quot;  &quot;305&quot;  &quot;306&quot; 
##  [307] &quot;307&quot;  &quot;308&quot;  &quot;309&quot;  &quot;310&quot;  &quot;311&quot;  &quot;312&quot;  &quot;313&quot;  &quot;314&quot;  &quot;315&quot; 
##  [316] &quot;316&quot;  &quot;317&quot;  &quot;318&quot;  &quot;319&quot;  &quot;320&quot;  &quot;321&quot;  &quot;322&quot;  &quot;323&quot;  &quot;324&quot; 
##  [325] &quot;325&quot;  &quot;326&quot;  &quot;327&quot;  &quot;328&quot;  &quot;329&quot;  &quot;330&quot;  &quot;331&quot;  &quot;332&quot;  &quot;333&quot; 
##  [334] &quot;334&quot;  &quot;335&quot;  &quot;336&quot;  &quot;337&quot;  &quot;338&quot;  &quot;339&quot;  &quot;340&quot;  &quot;341&quot;  &quot;342&quot; 
##  [343] &quot;343&quot;  &quot;344&quot;  &quot;345&quot;  &quot;346&quot;  &quot;347&quot;  &quot;348&quot;  &quot;349&quot;  &quot;350&quot;  &quot;351&quot; 
##  [352] &quot;352&quot;  &quot;353&quot;  &quot;354&quot;  &quot;355&quot;  &quot;356&quot;  &quot;357&quot;  &quot;358&quot;  &quot;359&quot;  &quot;360&quot; 
##  [361] &quot;361&quot;  &quot;362&quot;  &quot;363&quot;  &quot;364&quot;  &quot;365&quot;  &quot;366&quot;  &quot;367&quot;  &quot;368&quot;  &quot;369&quot; 
##  [370] &quot;370&quot;  &quot;371&quot;  &quot;372&quot;  &quot;373&quot;  &quot;374&quot;  &quot;375&quot;  &quot;376&quot;  &quot;377&quot;  &quot;378&quot; 
##  [379] &quot;379&quot;  &quot;380&quot;  &quot;381&quot;  &quot;382&quot;  &quot;383&quot;  &quot;384&quot;  &quot;385&quot;  &quot;386&quot;  &quot;387&quot; 
##  [388] &quot;388&quot;  &quot;389&quot;  &quot;390&quot;  &quot;391&quot;  &quot;392&quot;  &quot;393&quot;  &quot;394&quot;  &quot;395&quot;  &quot;396&quot; 
##  [397] &quot;397&quot;  &quot;398&quot;  &quot;399&quot;  &quot;400&quot;  &quot;401&quot;  &quot;402&quot;  &quot;403&quot;  &quot;404&quot;  &quot;405&quot; 
##  [406] &quot;406&quot;  &quot;407&quot;  &quot;408&quot;  &quot;409&quot;  &quot;410&quot;  &quot;411&quot;  &quot;412&quot;  &quot;413&quot;  &quot;414&quot; 
##  [415] &quot;415&quot;  &quot;416&quot;  &quot;417&quot;  &quot;418&quot;  &quot;419&quot;  &quot;420&quot;  &quot;421&quot;  &quot;422&quot;  &quot;423&quot; 
##  [424] &quot;424&quot;  &quot;425&quot;  &quot;426&quot;  &quot;427&quot;  &quot;428&quot;  &quot;429&quot;  &quot;430&quot;  &quot;431&quot;  &quot;432&quot; 
##  [433] &quot;433&quot;  &quot;434&quot;  &quot;435&quot;  &quot;436&quot;  &quot;437&quot;  &quot;438&quot;  &quot;439&quot;  &quot;440&quot;  &quot;441&quot; 
##  [442] &quot;442&quot;  &quot;443&quot;  &quot;444&quot;  &quot;445&quot;  &quot;446&quot;  &quot;447&quot;  &quot;448&quot;  &quot;449&quot;  &quot;450&quot; 
##  [451] &quot;451&quot;  &quot;452&quot;  &quot;453&quot;  &quot;454&quot;  &quot;455&quot;  &quot;456&quot;  &quot;457&quot;  &quot;458&quot;  &quot;459&quot; 
##  [460] &quot;460&quot;  &quot;461&quot;  &quot;462&quot;  &quot;463&quot;  &quot;464&quot;  &quot;465&quot;  &quot;466&quot;  &quot;467&quot;  &quot;468&quot; 
##  [469] &quot;469&quot;  &quot;470&quot;  &quot;471&quot;  &quot;472&quot;  &quot;473&quot;  &quot;474&quot;  &quot;475&quot;  &quot;476&quot;  &quot;477&quot; 
##  [478] &quot;478&quot;  &quot;479&quot;  &quot;480&quot;  &quot;481&quot;  &quot;482&quot;  &quot;483&quot;  &quot;484&quot;  &quot;485&quot;  &quot;486&quot; 
##  [487] &quot;487&quot;  &quot;488&quot;  &quot;489&quot;  &quot;490&quot;  &quot;491&quot;  &quot;492&quot;  &quot;493&quot;  &quot;494&quot;  &quot;495&quot; 
##  [496] &quot;496&quot;  &quot;497&quot;  &quot;498&quot;  &quot;499&quot;  &quot;500&quot;  &quot;501&quot;  &quot;502&quot;  &quot;503&quot;  &quot;504&quot; 
##  [505] &quot;505&quot;  &quot;506&quot;  &quot;507&quot;  &quot;508&quot;  &quot;509&quot;  &quot;510&quot;  &quot;511&quot;  &quot;512&quot;  &quot;513&quot; 
##  [514] &quot;514&quot;  &quot;515&quot;  &quot;516&quot;  &quot;517&quot;  &quot;518&quot;  &quot;519&quot;  &quot;520&quot;  &quot;521&quot;  &quot;522&quot; 
##  [523] &quot;523&quot;  &quot;524&quot;  &quot;525&quot;  &quot;526&quot;  &quot;527&quot;  &quot;528&quot;  &quot;529&quot;  &quot;530&quot;  &quot;531&quot; 
##  [532] &quot;532&quot;  &quot;533&quot;  &quot;534&quot;  &quot;535&quot;  &quot;536&quot;  &quot;537&quot;  &quot;538&quot;  &quot;539&quot;  &quot;540&quot; 
##  [541] &quot;541&quot;  &quot;542&quot;  &quot;543&quot;  &quot;544&quot;  &quot;545&quot;  &quot;546&quot;  &quot;547&quot;  &quot;548&quot;  &quot;549&quot; 
##  [550] &quot;550&quot;  &quot;551&quot;  &quot;552&quot;  &quot;553&quot;  &quot;554&quot;  &quot;555&quot;  &quot;556&quot;  &quot;557&quot;  &quot;558&quot; 
##  [559] &quot;559&quot;  &quot;560&quot;  &quot;561&quot;  &quot;562&quot;  &quot;563&quot;  &quot;564&quot;  &quot;565&quot;  &quot;566&quot;  &quot;567&quot; 
##  [568] &quot;568&quot;  &quot;569&quot;  &quot;570&quot;  &quot;571&quot;  &quot;572&quot;  &quot;573&quot;  &quot;574&quot;  &quot;575&quot;  &quot;576&quot; 
##  [577] &quot;577&quot;  &quot;578&quot;  &quot;579&quot;  &quot;580&quot;  &quot;581&quot;  &quot;582&quot;  &quot;583&quot;  &quot;584&quot;  &quot;585&quot; 
##  [586] &quot;586&quot;  &quot;587&quot;  &quot;588&quot;  &quot;589&quot;  &quot;590&quot;  &quot;591&quot;  &quot;592&quot;  &quot;593&quot;  &quot;594&quot; 
##  [595] &quot;595&quot;  &quot;596&quot;  &quot;597&quot;  &quot;598&quot;  &quot;599&quot;  &quot;600&quot;  &quot;601&quot;  &quot;602&quot;  &quot;603&quot; 
##  [604] &quot;604&quot;  &quot;605&quot;  &quot;606&quot;  &quot;607&quot;  &quot;608&quot;  &quot;609&quot;  &quot;610&quot;  &quot;611&quot;  &quot;612&quot; 
##  [613] &quot;613&quot;  &quot;614&quot;  &quot;615&quot;  &quot;616&quot;  &quot;617&quot;  &quot;618&quot;  &quot;619&quot;  &quot;620&quot;  &quot;621&quot; 
##  [622] &quot;622&quot;  &quot;623&quot;  &quot;624&quot;  &quot;625&quot;  &quot;626&quot;  &quot;627&quot;  &quot;628&quot;  &quot;629&quot;  &quot;630&quot; 
##  [631] &quot;631&quot;  &quot;632&quot;  &quot;633&quot;  &quot;634&quot;  &quot;635&quot;  &quot;636&quot;  &quot;637&quot;  &quot;638&quot;  &quot;639&quot; 
##  [640] &quot;640&quot;  &quot;641&quot;  &quot;642&quot;  &quot;643&quot;  &quot;644&quot;  &quot;645&quot;  &quot;646&quot;  &quot;647&quot;  &quot;648&quot; 
##  [649] &quot;649&quot;  &quot;650&quot;  &quot;651&quot;  &quot;652&quot;  &quot;653&quot;  &quot;654&quot;  &quot;655&quot;  &quot;656&quot;  &quot;657&quot; 
##  [658] &quot;658&quot;  &quot;659&quot;  &quot;660&quot;  &quot;661&quot;  &quot;662&quot;  &quot;663&quot;  &quot;664&quot;  &quot;665&quot;  &quot;666&quot; 
##  [667] &quot;667&quot;  &quot;668&quot;  &quot;669&quot;  &quot;670&quot;  &quot;671&quot;  &quot;672&quot;  &quot;673&quot;  &quot;674&quot;  &quot;675&quot; 
##  [676] &quot;676&quot;  &quot;677&quot;  &quot;678&quot;  &quot;679&quot;  &quot;680&quot;  &quot;681&quot;  &quot;682&quot;  &quot;683&quot;  &quot;684&quot; 
##  [685] &quot;685&quot;  &quot;686&quot;  &quot;687&quot;  &quot;688&quot;  &quot;689&quot;  &quot;690&quot;  &quot;691&quot;  &quot;692&quot;  &quot;693&quot; 
##  [694] &quot;694&quot;  &quot;695&quot;  &quot;696&quot;  &quot;697&quot;  &quot;698&quot;  &quot;699&quot;  &quot;700&quot;  &quot;701&quot;  &quot;702&quot; 
##  [703] &quot;703&quot;  &quot;704&quot;  &quot;705&quot;  &quot;706&quot;  &quot;707&quot;  &quot;708&quot;  &quot;709&quot;  &quot;710&quot;  &quot;711&quot; 
##  [712] &quot;712&quot;  &quot;713&quot;  &quot;714&quot;  &quot;715&quot;  &quot;716&quot;  &quot;717&quot;  &quot;718&quot;  &quot;719&quot;  &quot;720&quot; 
##  [721] &quot;721&quot;  &quot;722&quot;  &quot;723&quot;  &quot;724&quot;  &quot;725&quot;  &quot;726&quot;  &quot;727&quot;  &quot;728&quot;  &quot;729&quot; 
##  [730] &quot;730&quot;  &quot;731&quot;  &quot;732&quot;  &quot;733&quot;  &quot;734&quot;  &quot;735&quot;  &quot;736&quot;  &quot;737&quot;  &quot;738&quot; 
##  [739] &quot;739&quot;  &quot;740&quot;  &quot;741&quot;  &quot;742&quot;  &quot;743&quot;  &quot;744&quot;  &quot;745&quot;  &quot;746&quot;  &quot;747&quot; 
##  [748] &quot;748&quot;  &quot;749&quot;  &quot;750&quot;  &quot;751&quot;  &quot;752&quot;  &quot;753&quot;  &quot;754&quot;  &quot;755&quot;  &quot;756&quot; 
##  [757] &quot;757&quot;  &quot;758&quot;  &quot;759&quot;  &quot;760&quot;  &quot;761&quot;  &quot;762&quot;  &quot;763&quot;  &quot;764&quot;  &quot;765&quot; 
##  [766] &quot;766&quot;  &quot;767&quot;  &quot;768&quot;  &quot;769&quot;  &quot;770&quot;  &quot;771&quot;  &quot;772&quot;  &quot;773&quot;  &quot;774&quot; 
##  [775] &quot;775&quot;  &quot;776&quot;  &quot;777&quot;  &quot;778&quot;  &quot;779&quot;  &quot;780&quot;  &quot;781&quot;  &quot;782&quot;  &quot;783&quot; 
##  [784] &quot;784&quot;  &quot;785&quot;  &quot;786&quot;  &quot;787&quot;  &quot;788&quot;  &quot;789&quot;  &quot;790&quot;  &quot;791&quot;  &quot;792&quot; 
##  [793] &quot;793&quot;  &quot;794&quot;  &quot;795&quot;  &quot;796&quot;  &quot;797&quot;  &quot;798&quot;  &quot;799&quot;  &quot;800&quot;  &quot;801&quot; 
##  [802] &quot;802&quot;  &quot;803&quot;  &quot;804&quot;  &quot;805&quot;  &quot;806&quot;  &quot;807&quot;  &quot;808&quot;  &quot;809&quot;  &quot;810&quot; 
##  [811] &quot;811&quot;  &quot;812&quot;  &quot;813&quot;  &quot;814&quot;  &quot;815&quot;  &quot;816&quot;  &quot;817&quot;  &quot;818&quot;  &quot;819&quot; 
##  [820] &quot;820&quot;  &quot;821&quot;  &quot;822&quot;  &quot;823&quot;  &quot;824&quot;  &quot;825&quot;  &quot;826&quot;  &quot;827&quot;  &quot;828&quot; 
##  [829] &quot;829&quot;  &quot;830&quot;  &quot;831&quot;  &quot;832&quot;  &quot;833&quot;  &quot;834&quot;  &quot;835&quot;  &quot;836&quot;  &quot;837&quot; 
##  [838] &quot;838&quot;  &quot;839&quot;  &quot;840&quot;  &quot;841&quot;  &quot;842&quot;  &quot;843&quot;  &quot;844&quot;  &quot;845&quot;  &quot;846&quot; 
##  [847] &quot;847&quot;  &quot;848&quot;  &quot;849&quot;  &quot;850&quot;  &quot;851&quot;  &quot;852&quot;  &quot;853&quot;  &quot;854&quot;  &quot;855&quot; 
##  [856] &quot;856&quot;  &quot;857&quot;  &quot;858&quot;  &quot;859&quot;  &quot;860&quot;  &quot;861&quot;  &quot;862&quot;  &quot;863&quot;  &quot;864&quot; 
##  [865] &quot;865&quot;  &quot;866&quot;  &quot;867&quot;  &quot;868&quot;  &quot;869&quot;  &quot;870&quot;  &quot;871&quot;  &quot;872&quot;  &quot;873&quot; 
##  [874] &quot;874&quot;  &quot;875&quot;  &quot;876&quot;  &quot;877&quot;  &quot;878&quot;  &quot;879&quot;  &quot;880&quot;  &quot;881&quot;  &quot;882&quot; 
##  [883] &quot;883&quot;  &quot;884&quot;  &quot;885&quot;  &quot;886&quot;  &quot;887&quot;  &quot;888&quot;  &quot;889&quot;  &quot;890&quot;  &quot;891&quot; 
##  [892] &quot;892&quot;  &quot;893&quot;  &quot;894&quot;  &quot;895&quot;  &quot;896&quot;  &quot;897&quot;  &quot;898&quot;  &quot;899&quot;  &quot;900&quot; 
##  [901] &quot;901&quot;  &quot;902&quot;  &quot;903&quot;  &quot;904&quot;  &quot;905&quot;  &quot;906&quot;  &quot;907&quot;  &quot;908&quot;  &quot;909&quot; 
##  [910] &quot;910&quot;  &quot;911&quot;  &quot;912&quot;  &quot;913&quot;  &quot;914&quot;  &quot;915&quot;  &quot;916&quot;  &quot;917&quot;  &quot;918&quot; 
##  [919] &quot;919&quot;  &quot;920&quot;  &quot;921&quot;  &quot;922&quot;  &quot;923&quot;  &quot;924&quot;  &quot;925&quot;  &quot;926&quot;  &quot;927&quot; 
##  [928] &quot;928&quot;  &quot;929&quot;  &quot;930&quot;  &quot;931&quot;  &quot;932&quot;  &quot;933&quot;  &quot;934&quot;  &quot;935&quot;  &quot;936&quot; 
##  [937] &quot;937&quot;  &quot;938&quot;  &quot;939&quot;  &quot;940&quot;  &quot;941&quot;  &quot;942&quot;  &quot;943&quot;  &quot;944&quot;  &quot;945&quot; 
##  [946] &quot;946&quot;  &quot;947&quot;  &quot;948&quot;  &quot;949&quot;  &quot;950&quot;  &quot;951&quot;  &quot;952&quot;  &quot;953&quot;  &quot;954&quot; 
##  [955] &quot;955&quot;  &quot;956&quot;  &quot;957&quot;  &quot;958&quot;  &quot;959&quot;  &quot;960&quot;  &quot;961&quot;  &quot;962&quot;  &quot;963&quot; 
##  [964] &quot;964&quot;  &quot;965&quot;  &quot;966&quot;  &quot;967&quot;  &quot;968&quot;  &quot;969&quot;  &quot;970&quot;  &quot;971&quot;  &quot;972&quot; 
##  [973] &quot;973&quot;  &quot;974&quot;  &quot;975&quot;  &quot;976&quot;  &quot;977&quot;  &quot;978&quot;  &quot;979&quot;  &quot;980&quot;  &quot;981&quot; 
##  [982] &quot;982&quot;  &quot;983&quot;  &quot;984&quot;  &quot;985&quot;  &quot;986&quot;  &quot;987&quot;  &quot;988&quot;  &quot;989&quot;  &quot;990&quot; 
##  [991] &quot;991&quot;  &quot;992&quot;  &quot;993&quot;  &quot;994&quot;  &quot;995&quot;  &quot;996&quot;  &quot;997&quot;  &quot;998&quot;  &quot;999&quot; 
## [1000] &quot;1000&quot;</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1">group &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span>,n))</a>
<a class="sourceLine" id="cb151-2" title="2">dat0 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(y,times,group)</a>
<a class="sourceLine" id="cb151-3" title="3"></a>
<a class="sourceLine" id="cb151-4" title="4"><span class="kw">glmmTMB</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">ar1</span>(times <span class="op">+</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>group), <span class="dt">data=</span>dat0)</a></code></pre></div>
<pre><code>## Formula:          y ~ ar1(times + 0 | group)
## Data: dat0
##       AIC       BIC    logLik  df.resid 
##  843.4275  863.0585 -417.7138       996 
## Random-effects (co)variances:
## 
## Conditional model:
##  Groups   Name   Std.Dev. Corr      
##  group    times1 0.1833   0.29 (ar1)
##  Residual        0.3196             
## 
## Number of obs: 1000 / Conditional model: group, 1
## 
## Dispersion estimate for gaussian family (sigma^2): 0.102 
## 
## Fixed Effects:
## 
## Conditional model:
## (Intercept)  
##      0.8379</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/50-trying.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
